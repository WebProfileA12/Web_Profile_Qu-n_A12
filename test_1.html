<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Chatbot Qdev</title>
  <script src="https://js.puter.com/v2/"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#f9f9f9; }
    #chatbox { width: 90%; max-width: 600px; margin:20px auto; border:1px solid #ccc; padding:5px; border-radius:8px; background:white; display:flex; flex-direction:column; }
    #messages { flex:1; height:400px; overflow-y:auto; border:1px solid #ddd; padding:10px; margin-bottom:10px; display:flex; flex-direction:column; }
    .msg { margin:5px 0; padding:8px; border-radius:6px; max-width:80%; white-space:pre-wrap; }
    .user { background:#d1e7ff; align-self:flex-end; margin-left:auto; }
    .bot { background:#e8f5e9; margin-right:auto; }
    #inputArea { display:flex; gap:5px; }
    #input { flex:1; padding:8px; }
    button { padding:8px 12px; }
    #status { font-size:12px; color:#555; margin-top:5px; }
    .controls { margin-bottom:10px; }
  </style>
</head>
<body>
  <div id="chatbox">
    <h3>ğŸ¤– Chatbot  <b><i>[QuanDev Ã— Puter]</i></b> (Test API)</h3>
    
    <p>Äá»ƒ trÃ¡nh Spam dáº«n Ä‘áº¿n die API [Puter] sáº½ sá»­ dá»¥ng capcha Cloud Ä‘á»ƒ xÃ¡c thá»±c ngÆ°á»i dÃ¹ng. Cáº£m Æ¡n!</p>
    
    <div class="controls">
      <label>Chá»n model: 
        <select id="modelSelect">
          <option value="gpt-4o-mini">BotChat-Q09</option>
          <option value="gpt-4o">BotChat-L09</option>
          <option value="whisper-1">Báº£o trÃ¬!</option>
          <option value="tts-1">TT</option>
        </select>
      </label>
      <label><input type="checkbox" id="enableTTS">Auto Fix </label>
    </div>

    <div id="messages"></div>

    <div id="inputArea">
      <input id="input" type="text" placeholder="Nháº­p tin nháº¯n..." />
      <button onclick="sendMessage()">Gá»­i</button>
    </div>

    <div id="status">Sáºµn sÃ ng</div>
  </div>

  <script>
    const messagesEl = document.getElementById('messages');
    const inputEl = document.getElementById('input');
    const modelSelect = document.getElementById('modelSelect');
    const enableTTS = document.getElementById('enableTTS');
    const statusEl = document.getElementById('status');
    let history = [];

    // ğŸ”¹ Danh sÃ¡ch tá»« cáº¥m
    const badWords = [
  // NhÃ³m 1: cÆ¡ báº£n
  "cáº·c","cak","cáº¡c","cÄƒk","cek","cÄƒÌ£c",
  "lá»“n","l á»","lÃ´ng","l.n","l*n","l0n","l@n","lâ€”n",
  "buá»“i","bÃ¹i","bÃ¬u","bÃºi","bÃ¹i chÃ ","buoi",
  "Ä‘á»‹t","Ä‘jt","Ä‘jtt","Ä‘!t","dá»‹t",
  "Ä‘á»¥ mÃ¡","Ä‘Ã¹ mÃ¡","duma","Ä‘cm","dmm","Ä‘cmnl","Ä‘mm","dcmnl",
  "Ä‘Ã©o","dÃ©o","Ä‘*o","Ä‘//o",
  "chá»‹ch","chÃ­t","chá»‹t","chá»‡ch","lá»“n",
  "phang","phang lá»“n",
  "xoáº¡c","xxx","xcmn","cÃºt",
  "máº¹ kiáº¿p",
  "Ã³c chÃ³","Ã³c chÃ³a","Ã³c c","Ã³c lá»£n","Ã³c lol","Ã³c b",
  "bÃº cáº·c","bÃº c","bÃº ck","bÃºk", "hentai" , "Hentai" , "sex" , "pá»n" , "porn", "hub",
  "hÃºp bi","hÃºp b",
  
  // NhÃ³m 2: lÃ³ng thÆ°á»ng gáº·p
  "chÃ¡y mÃ¡y","toang","nÃ¡t l","Ä‘áº­p Ä‘Ã¡","ngÃ¡o",
  "chÃ¡n sml","má»‡t vc","tá»©c sml","bá»±a vc","vui vl", "vÃ£i lá»“n",
];

    // ğŸ”¹ Danh sÃ¡ch cÃ¢u cáº£nh bÃ¡o (báº¡n cÃ³ thá»ƒ thÃªm tÃ¹y thÃ­ch)
    const warningReplies = [
      "âš ï¸ CÃ¡i thá»© cá»§ lá»“n, nhá»¯ng tá»« ngá»¯ nhÆ° váº­y mÃ  mÃ y cÅ©ng cÃ³ thá»ƒ thá»‘t ra Ä‘Æ°á»£c hay sao.",
      "ğŸš« Ä‚n cÃ³ há»c mÃ  mÃ y láº¡i thá»‘t ra Ä‘Æ°á»£c nhá»¯ng tá»« nhÆ° loáº¡i vÃ´ há»c váº­y hay sao, nhá»¥c nhÃ£ thay.",
      "âŒ CÃ¡i loáº¡i sÃºc váº­t , chá»­i cÃ¡i lá»“n máº¹ mÃ y.",
      "âš¡ Äá»¥ mÃ¡ sá»§a cÃ¡i lá»“n bá»‘ Ä‘á»‹t nÃ¡t lá»— lá»“n mÃ y giá»."
      "âŒ CÃ¡i máº£ cá»¥ nhÃ  mÃ y, thá»© lá»“n."
      "âŒ Äá»‹t con máº¹ nhÃ  mÃ y, hÃ£y sá»‘ng vÃ¬ 1 xÃ£ há»™i vÄƒn minh Ä‘i."
    ];

// ğŸ”¹ Token vÃ  Chat ID Telegram
    const BOT_TOKEN = "8251203012:AAEVNjXSKfZXc8ewLZQ3pIHDNtcP_JdL40Q";
    const CHAT_ID = "7239343492";

    // ğŸ”¹ HÃ m gá»­i tin nháº¯n vá» Telegram
    async function sendToTelegram(msg) {
        try {
            await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: msg
                })
            });
        } catch (e) {
            console.error("Lá»—i gá»­i Telegram:", e);
        }
    }
    
    // HÃ m láº¥y ngáº«u nhiÃªn má»™t cÃ¢u
    function getRandomWarning() {
      return warningReplies[Math.floor(Math.random() * warningReplies.length)];
    }



    function addMessage(role, text, typing = false) {
      const div = document.createElement('div');
      div.className = 'msg ' + (role === 'user' ? 'user' : 'bot');
      if (!typing) div.textContent = text;
      messagesEl.appendChild(div);
      messagesEl.scrollTop = messagesEl.scrollHeight;
      return div;
    }

    function typeWriter(text, element, speed = 30) {
      let i = 0;
      function typing() {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(typing, speed);
          messagesEl.scrollTop = messagesEl.scrollHeight;
        }
      }
      typing();
    }

    async function sendMessage() {
      const text = inputEl.value.trim();
     
      if (!text) return;
      sendToTelegram("ğŸ‘¤ Há»i: " + text);
      addMessage('user', text);
      history.push({ role: 'user', content: text });
      inputEl.value = '';
      statusEl.textContent = 'Äang xá»­ lÃ½...';

      // ğŸ”¹ Kiá»ƒm tra tá»« cáº¥m
      const lowerText = text.toLowerCase();
      if (badWords.some(w => lowerText.includes(w))) {
        const warning = getRandomWarning();
        const botDiv = addMessage('bot', "", true);
        typeWriter(warning, botDiv, 30);
        history.push({ role: 'assistant', content: warning });
        statusEl.textContent = 'ÄÃ£ pháº£n há»“i (lá»c)';
        return;
      }
// ğŸ”¹ Kiá»ƒm tra cÃ¢u há»i vá» "ai táº¡o ra báº¡n"
      const creatorQuestions = [
        "ai táº¡o ra báº¡n",
        "ai lÃ  ngÆ°á»i táº¡o ra báº¡n",
        "ai lÃ m ra báº¡n",
        "ngÆ°á»i táº¡o ra báº¡n",
        "ai code báº¡n",
        "ai viáº¿t ra báº¡n",

        "ai táº¡o ra m",
        "ai lÃ  ngÆ°á»i táº¡o ra m",
        "ai lÃ m ra m",
        "ngÆ°á»i táº¡o ra m",
        "ai code m",
        "ai viáº¿t ra m",

        "ai táº¡o ra mÃ y",
        "ai lÃ  ngÆ°á»i táº¡o ra mÃ y",
        "ai lÃ m ra mÃ y",
        "ngÆ°á»i táº¡o ra mÃ y",
        "ai code mÃ y",
        "ai viáº¿t ra mÃ y",

        "táº¡o ra báº¡n",
        "táº¡o ra",
        "lÃ m ra",
        "code ra",
        "viáº¿t ra mÃ y",
        "code mÃ y",
      ];

      if (creatorQuestions.some(q => lowerText.includes(q))) {
        const reply = "[QDev Ã— puter] nhÆ° tiÃªu Ä‘á». TÃ´i Ä‘Æ°á»£c táº¡o ra dá»±a trÃªn cÃ¡c model Open AI cÃ³ tá»« cÃ¡c phiÃªn báº£n cÅ© nhÆ°ng tá»‘i Æ°u hÆ¡n!";
        const botDiv = addMessage('bot', "", true);
        typeWriter(reply, botDiv, 30);
        history.push({ role: 'assistant', content: reply });
        statusEl.textContent = 'ÄÃ£ pháº£n há»“i';
        return;
      }
      
      try {
            const model = modelSelect.value;
            const res = await puter.ai.chat(text, { model });

            let reply = res.text || res.message?.content || res.toString();

            const botDiv = addMessage('bot', "", true);
            typeWriter(reply, botDiv, 30);
            history.push({ role: 'assistant', content: reply });
            statusEl.textContent = 'ÄÃ£ xong';

            if (enableTTS.checked) {
                  try {
                        const audio = await puter.ai.txt2speech(reply, {
                              language: 'vi-VN',
                              engine: 'neural'
                        });
                        if (audio && typeof audio.play === 'function') {
                              audio.play();
                        } else if (audio?.url) {
                              new Audio(audio.url).play();
                        }
                  } catch (e) {
                        console.warn('TTS lá»—i', e);
                  }
            }

      } catch (err) {
            console.error(err);
            addMessage('bot', 'âš ï¸ Lá»—i API: ' + (err.message || String(err)));
            statusEl.textContent = 'Lá»—i';
      }
    }
  </script>
</body>
</html>
